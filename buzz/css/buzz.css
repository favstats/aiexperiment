/* ============================================
   BUZZCHAT - Buzz Chat CSS
   Social media simulator for research
   ============================================ */

/* ============================================
   CSS VARIABLES
   ============================================ */
:root {
  --wa-green-dark: #075E54;
  --wa-green-header: #128C7E;
  --wa-green-light: #25D366;
  --wa-green-message: #DCF8C6;
  --wa-green-message-hover: #d4f0be;
  --wa-teal: #00A884;
  --wa-teal-dark: #008069;
  --wa-blue-check: #53BDEB;
  --wa-blue-link: #027EB5;
  --wa-bg: #ECE5DD;
  --wa-bg-panel: #F0F2F5;
  --wa-bg-chat: #EFEAE2;
  --wa-bg-sidebar: #FFFFFF;
  --wa-bg-input: #FFFFFF;
  --wa-white: #FFFFFF;
  --wa-message-out: #D9FDD3;
  --wa-message-in: #FFFFFF;
  --wa-text-primary: #111B21;
  --wa-text-secondary: #667781;
  --wa-text-light: #8696A0;
  --wa-text-time: #667781;
  --wa-border: #E9EDEF;
  --wa-border-dark: #D1D7DB;
  --wa-search-bg: #F0F2F5;
  --wa-hover: #F5F6F6;
  --wa-unread-bg: #25D366;
  --wa-unread-text: #FFFFFF;
  --wa-forwarded-color: #8696A0;
  --wa-shadow: 0 1px 0.5px rgba(11, 20, 26, 0.13);
  --wa-shadow-heavy: 0 2px 5px rgba(0, 0, 0, 0.1);
  --wa-header-height: 59px;
  --wa-input-height: 62px;
  --wa-sidebar-width: 30%;
  --wa-sidebar-min: 340px;
}

/* ============================================
   RESET & BASE
   ============================================ */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html, body {
  height: 100%;
  overflow: hidden;
  font-family: 'Segoe UI', Helvetica, Arial, sans-serif;
  font-size: 14px;
  color: var(--wa-text-primary);
  background: var(--wa-bg);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ============================================
   LOADING SCREEN
   Buzz style: centered icon, app name,
   subtle progress bar on gray background
   ============================================ */
.buzzchat-loader {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: #E8E8E8;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  transition: opacity 0.5s ease;
}

.buzzchat-loader.fade-out {
  opacity: 0;
  pointer-events: none;
}

.buzzchat-loader-icon {
  width: 64px;
  height: 64px;
  border-radius: 0;
  background: none;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 20px;
  animation: none;
}

.buzzchat-loader-icon i {
  font-size: 56px;
  color: #BFC8CF;
}

.buzzchat-loader-title {
  font-size: 16px;
  font-weight: 400;
  color: #667781;
  margin-bottom: 6px;
  letter-spacing: 0;
}

.buzzchat-loader-text {
  font-size: 13px;
  color: #8696A0;
  margin-bottom: 28px;
}

.buzzchat-loader-bar {
  width: 260px;
  height: 3px;
  background: #D1D7DB;
  border-radius: 3px;
  overflow: hidden;
}

.buzzchat-loader-bar-fill {
  height: 100%;
  width: 0%;
  background: var(--wa-teal);
  border-radius: 3px;
  animation: loaderFill 3s ease-in-out forwards;
}

@keyframes loaderFill {
  0% { width: 0%; }
  30% { width: 50%; }
  60% { width: 75%; }
  100% { width: 100%; }
}

/* ============================================
   APP SHELL - 2 PANEL LAYOUT
   ============================================ */
.buzzchat-app {
  display: none;
  width: 100%;
  height: 100vh;
  max-width: 1600px;
  margin: 0 auto;
  background: var(--wa-white);
  overflow: hidden;
  position: relative;
}

.buzzchat-app.loaded {
  display: flex;
}

/* Outer frame with top/bottom bars */
.buzzchat-frame {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  position: relative;
}

/* Dark teal top bar - accent strip behind the top of panels */
.buzzchat-top-bar {
  height: 128px;
  background: var(--wa-teal-dark);
  flex-shrink: 0;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  z-index: 0;
}

.buzzchat-main {
  flex: 1;
  display: flex;
  overflow: hidden;
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.06),
              0 2px 5px rgba(0, 0, 0, 0.07);
  position: relative;
  z-index: 1;
  margin-top: 19px;
  margin-bottom: 19px;
  margin-left: 19px;
  margin-right: 19px;
  border-radius: 0;
}

/* ============================================
   LEFT PANEL - CHAT LIST
   ============================================ */
.buzzchat-sidebar {
  width: var(--wa-sidebar-width);
  min-width: var(--wa-sidebar-min);
  max-width: 440px;
  background: var(--wa-bg-sidebar);
  border-right: 1px solid var(--wa-border);
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
}

/* Sidebar header */
.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 16px;
  height: var(--wa-header-height);
  background: var(--wa-bg-panel);
  flex-shrink: 0;
}

.sidebar-header-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: var(--wa-border-dark);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.sidebar-header-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.sidebar-header-avatar i {
  font-size: 20px;
  color: var(--wa-text-light);
}

.sidebar-header-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.sidebar-header-actions button {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: none;
  background: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--wa-text-light);
  font-size: 19px;
  transition: background 0.15s;
}

.sidebar-header-actions button:hover {
  background: var(--wa-hover);
}

/* Sidebar search */
.sidebar-search {
  padding: 8px 12px 6px;
  background: var(--wa-bg-sidebar);
  flex-shrink: 0;
}

.sidebar-search-input {
  display: flex;
  align-items: center;
  gap: 12px;
  background: var(--wa-search-bg);
  border-radius: 8px;
  padding: 0 12px;
  height: 35px;
}

.sidebar-search-input i {
  font-size: 14px;
  color: var(--wa-text-light);
  flex-shrink: 0;
}

.sidebar-search-input input {
  flex: 1;
  border: none;
  background: none;
  font-size: 13px;
  color: var(--wa-text-primary);
  outline: none;
}

.sidebar-search-input input::placeholder {
  color: var(--wa-text-light);
}

/* ============================================
   SIDEBAR FILTER TABS (All, Unread, Favorites, Groups)
   ============================================ */
.sidebar-filters {
  display: flex;
  gap: 8px;
  padding: 8px 12px 8px;
  flex-shrink: 0;
  border-bottom: 1px solid var(--wa-border);
}

.sidebar-filter {
  border: none;
  background: var(--wa-search-bg);
  color: var(--wa-text-secondary);
  font-size: 13px;
  font-weight: 400;
  padding: 5px 14px;
  border-radius: 18px;
  cursor: pointer;
  transition: background 0.2s, color 0.2s;
  white-space: nowrap;
  font-family: inherit;
  line-height: 1.3;
}

.sidebar-filter:hover {
  background: #E4E7EB;
}

.sidebar-filter.active {
  background: var(--wa-teal-dark);
  color: white;
}

.sidebar-filter.active:hover {
  background: var(--wa-teal);
}

/* Chat list */
.chat-list {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
}

.chat-list-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 16px;
  cursor: pointer;
  transition: background 0.15s;
  border-bottom: none;
  position: relative;
}

/* Subtle separator on the info section only, not full-width */
.chat-list-item .chat-list-info {
  border-bottom: 1px solid var(--wa-border);
  padding-bottom: 10px;
}

.chat-list-item:last-child .chat-list-info {
  border-bottom: none;
}

.chat-list-item:hover {
  background: var(--wa-hover);
}

.chat-list-item.active {
  background: var(--wa-hover);
}

.chat-list-avatar {
  width: 49px;
  height: 49px;
  border-radius: 50%;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  background: var(--wa-border-dark);
}

.chat-list-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.chat-list-avatar i {
  font-size: 24px;
  color: var(--wa-text-light);
}

.chat-list-avatar.group-avatar {
  background: linear-gradient(135deg, var(--wa-teal), var(--wa-green-dark));
  color: white;
}

.chat-list-avatar.group-avatar i {
  color: white;
  font-size: 22px;
}

.chat-list-info {
  flex: 1;
  min-width: 0;
}

.chat-list-top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2px;
}

.chat-list-name {
  font-size: 16px;
  font-weight: 400;
  color: var(--wa-text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-list-time {
  font-size: 12px;
  color: var(--wa-text-light);
  flex-shrink: 0;
  margin-left: 8px;
}

.chat-list-time.unread {
  color: var(--wa-unread-bg);
}

.chat-list-bottom {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.chat-list-preview {
  font-size: 13px;
  color: var(--wa-text-light);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  line-height: 1.4;
}

.chat-list-badge {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--wa-unread-bg);
  color: var(--wa-unread-text);
  font-size: 11px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  margin-left: 8px;
}

/* ============================================
   RIGHT PANEL - CHAT AREA
   ============================================ */
.buzzchat-chat {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
  background: var(--wa-bg-chat);
  position: relative;
}

/* Chat wallpaper - doodle pattern with tiny icons */
.buzzchat-chat::before {
  content: '';
  position: absolute;
  inset: 0;
  opacity: 0.4;
  background-color: #EFEAE2;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300' viewBox='0 0 300 300'%3E%3Cdefs%3E%3Cstyle%3E.a%7Bfill:%23dbd5cc;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3C!-- Clock --%3E%3Ccircle class='a' cx='25' cy='20' r='6'/%3E%3Cline x1='25' y1='20' x2='25' y2='16' stroke='%23dbd5cc' stroke-width='1.5' stroke-linecap='round'/%3E%3Cline x1='25' y1='20' x2='28' y2='20' stroke='%23dbd5cc' stroke-width='1.5' stroke-linecap='round'/%3E%3C!-- Phone --%3E%3Crect class='a' x='65' y='12' width='7' height='12' rx='1.5'/%3E%3C!-- Music note --%3E%3Ccircle class='a' cx='110' cy='27' r='3'/%3E%3Cline x1='113' y1='27' x2='113' y2='14' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Cline x1='113' y1='14' x2='118' y2='16' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3C!-- Heart --%3E%3Cpath class='a' d='M155,20 C155,16 160,13 163,17 C166,13 171,16 171,20 C171,25 163,30 163,30 C163,30 155,25 155,20Z'/%3E%3C!-- Chat bubble --%3E%3Cpath class='a' d='M205,14 h14 a3,3 0 0 1 3,3 v8 a3,3 0 0 1 -3,3 h-8 l-4,4 v-4 h-2 a3,3 0 0 1 -3,-3 v-8 a3,3 0 0 1 3,-3z'/%3E%3C!-- Camera --%3E%3Crect class='a' x='250' y='17' width='14' height='10' rx='2'/%3E%3Ccircle class='a' cx='257' cy='22' r='3'/%3E%3Cpath class='a' d='M253,17 l2,-3 h4 l2,3'/%3E%3C!-- Star --%3E%3Cpolygon class='a' points='30,65 32,71 38,71 33,75 35,81 30,77 25,81 27,75 22,71 28,71'/%3E%3C!-- Smiley --%3E%3Ccircle class='a' cx='75' cy='72' r='7'/%3E%3C!-- Paper plane --%3E%3Cpath class='a' d='M110,62 l18,8 -18,8 3,-8z'/%3E%3C!-- Lock --%3E%3Crect class='a' x='157' y='70' width='10' height='8' rx='1'/%3E%3Cpath d='M159,70 v-3 a3,3 0 0 1 6,0 v3' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3C!-- Globe --%3E%3Ccircle class='a' cx='210' cy='72' r='6'/%3E%3Cellipse class='a' cx='210' cy='72' rx='3' ry='6'/%3E%3Cline x1='204' y1='72' x2='216' y2='72' stroke='%23dbd5cc' stroke-width='0.8'/%3E%3C!-- Mic --%3E%3Crect class='a' x='257' y='64' width='6' height='10' rx='3'/%3E%3Cpath d='M255,74 a6,5 0 0 0 10,0' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Cline x1='260' y1='79' x2='260' y2='82' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3C!-- Headphones --%3E%3Cpath d='M20,125 a8,8 0 0 1 16,0' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Crect class='a' x='18' y='123' width='4' height='7' rx='1'/%3E%3Crect class='a' x='34' y='123' width='4' height='7' rx='1'/%3E%3C!-- Book --%3E%3Crect class='a' x='63' y='115' width='12' height='15' rx='1'/%3E%3Cline x1='69' y1='115' x2='69' y2='130' stroke='%23c8c3ba' stroke-width='0.8'/%3E%3C!-- Pin/Location --%3E%3Cpath class='a' d='M112,115 a5,5 0 0 1 5,5 c0,5 -5,9 -5,9 s-5,-4 -5,-9 a5,5 0 0 1 5,-5z'/%3E%3Ccircle cx='112' cy='120' r='2' fill='%23EFEAE2'/%3E%3C!-- Wi-Fi --%3E%3Cpath d='M155,125 a10,10 0 0 1 14,0' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Cpath d='M158,122 a6,6 0 0 1 8,0' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Ccircle class='a' cx='162' cy='126' r='1.5'/%3E%3C!-- Thumbs up --%3E%3Cpath class='a' d='M207,128 h8 v-8 l-3,-5 h-2 v5 h-3z'/%3E%3C!-- Key --%3E%3Ccircle class='a' cx='258' cy='118' r='4'/%3E%3Cline x1='262' y1='118' x2='270' y2='118' stroke='%23dbd5cc' stroke-width='2'/%3E%3Cline x1='268' y1='118' x2='268' y2='122' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3C!-- Lightning bolt --%3E%3Cpolygon class='a' points='28,168 34,168 31,178 37,178 26,192 29,182 24,182'/%3E%3C!-- Envelope --%3E%3Crect class='a' x='63' y='170' width='14' height='10' rx='1'/%3E%3Cpath d='M63,170 l7,6 7,-6' fill='none' stroke='%23c8c3ba' stroke-width='0.8'/%3E%3C!-- Photo/Image --%3E%3Crect class='a' x='107' y='168' width='14' height='12' rx='1'/%3E%3Ccircle cx='112' cy='172' r='2' fill='%23c8c3ba'/%3E%3Cpath d='M107,178 l4,-3 3,2 3,-2 4,3' fill='%23c8c3ba'/%3E%3C!-- Document --%3E%3Cpath class='a' d='M157,165 h8 l4,4 v12 h-12z'/%3E%3Cpath d='M165,165 v4 h4' fill='none' stroke='%23c8c3ba' stroke-width='0.8'/%3E%3C!-- Bell --%3E%3Cpath class='a' d='M210,178 a5,5 0 0 1 -10,0 v-5 a5,5 0 0 1 10,0z'/%3E%3Cline x1='205' y1='178' x2='215' y2='178' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Ccircle class='a' cx='210' cy='181' r='1.5'/%3E%3C!-- Magnifying glass --%3E%3Ccircle cx='258' cy='172' r='5' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Cline x1='262' y1='176' x2='266' y2='180' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3C!-- Video camera --%3E%3Crect class='a' x='20' y='220' width='12' height='9' rx='1.5'/%3E%3Cpath class='a' d='M32,222 l5,-2 v10 l-5,-2z'/%3E%3C!-- Paperclip --%3E%3Cpath d='M70,228 v-10 a4,4 0 0 1 8,0 v12 a6,6 0 0 1 -12,0 v-8' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3C!-- Calendar --%3E%3Crect class='a' x='107' y='220' width='14' height='12' rx='1.5'/%3E%3Cline x1='107' y1='225' x2='121' y2='225' stroke='%23c8c3ba' stroke-width='0.8'/%3E%3Cline x1='111' y1='218' x2='111' y2='222' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Cline x1='117' y1='218' x2='117' y2='222' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3C!-- Check mark --%3E%3Cpath d='M157,228 l3,4 7,-8' fill='none' stroke='%23dbd5cc' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C!-- Laptop --%3E%3Crect class='a' x='202' y='218' width='16' height='11' rx='1'/%3E%3Cpath class='a' d='M199,229 h22 l-2,3 h-18z'/%3E%3C!-- Link/Chain --%3E%3Cpath d='M255,220 a4,4 0 0 1 0,7 l-2,2' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Cpath d='M263,230 a4,4 0 0 1 0,-7 l2,-2' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3C!-- Coffee cup --%3E%3Crect class='a' x='22' y='270' width='10' height='10' rx='1'/%3E%3Cpath d='M32,272 a3,3 0 0 1 0,6' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3C!-- Pencil --%3E%3Cpath class='a' d='M70,280 l10,-12 3,3 -10,12z'/%3E%3Cpath class='a' d='M80,268 l3,3 2,-2 -3,-3z'/%3E%3C!-- Dollar sign --%3E%3Ccircle class='a' cx='114' cy='278' r='7'/%3E%3Ctext x='111' y='282' font-size='10' fill='%23c8c3ba' font-weight='bold'%3E$%3C/text%3E%3C!-- Flame --%3E%3Cpath class='a' d='M162,285 c0,-8 5,-12 5,-12 s2,3 0,7 c3,-2 4,-5 4,-5 s3,4 0,10 a7,7 0 0 1 -9,0z'/%3E%3C!-- Airplane --%3E%3Cpath class='a' d='M205,280 l15,-8 -4,8 4,8z'/%3E%3Cpath class='a' d='M209,278 l-5,-3 3,5z'/%3E%3Cpath class='a' d='M209,282 l-5,3 3,-5z'/%3E%3C!-- Trophy --%3E%3Crect class='a' x='256' y='270' width='10' height='9' rx='0'/%3E%3Cpath d='M256,272 a4,4 0 0 0 0,5' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Cpath d='M266,272 a4,4 0 0 1 0,5' fill='none' stroke='%23dbd5cc' stroke-width='1.5'/%3E%3Crect class='a' x='259' y='279' width='4' height='3'/%3E%3Crect class='a' x='257' y='282' width='8' height='2' rx='0.5'/%3E%3C/g%3E%3C/svg%3E");
  background-size: 300px 300px;
  pointer-events: none;
  z-index: 0;
}

/* Chat header */
.chat-header {
  display: flex;
  align-items: center;
  padding: 10px 16px;
  height: var(--wa-header-height);
  background: var(--wa-bg-panel);
  border-bottom: 1px solid var(--wa-border);
  flex-shrink: 0;
  z-index: 2;
  gap: 12px;
}

.chat-header-back {
  display: none;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: none;
  background: none;
  cursor: pointer;
  align-items: center;
  justify-content: center;
  color: var(--wa-text-light);
  font-size: 20px;
  flex-shrink: 0;
  margin-right: -4px;
}

.chat-header-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--wa-teal), var(--wa-green-dark));
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  overflow: hidden;
}

.chat-header-avatar i {
  color: white;
  font-size: 18px;
}

.chat-header-info {
  flex: 1;
  min-width: 0;
}

.chat-header-name {
  font-size: 16px;
  font-weight: 500;
  color: var(--wa-text-primary);
  line-height: 1.2;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-header-status {
  font-size: 13px;
  color: var(--wa-text-light);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-header-actions {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
}

.chat-header-actions button {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: none;
  background: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--wa-text-light);
  font-size: 18px;
  transition: background 0.15s;
}

.chat-header-actions button:hover {
  background: var(--wa-hover);
}

/* ============================================
   MESSAGE AREA
   ============================================ */
.chat-messages {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 16px 48px;
  z-index: 1;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
}

/* Date divider */
.chat-date-divider {
  display: flex;
  justify-content: center;
  margin: 12px 0;
}

.chat-date-divider span {
  background: rgba(255, 255, 255, 0.9);
  padding: 5px 12px;
  border-radius: 8px;
  font-size: 12.5px;
  color: var(--wa-text-secondary);
  box-shadow: 0 1px 0.5px rgba(11, 20, 26, 0.13);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.02em;
}

/* Encryption notice */
.chat-encryption-notice {
  display: flex;
  justify-content: center;
  margin: 8px 0 16px;
}

.chat-encryption-notice span {
  background: rgba(255, 234, 159, 0.5);
  padding: 6px 14px;
  border-radius: 8px;
  font-size: 12px;
  color: var(--wa-text-secondary);
  display: flex;
  align-items: center;
  gap: 6px;
  line-height: 1.4;
  text-align: center;
  max-width: 480px;
}

.chat-encryption-notice i {
  font-size: 13px;
  color: #C8A92C;
  flex-shrink: 0;
}

/* ============================================
   MESSAGE BUBBLES
   ============================================ */
.message-wrapper {
  display: flex;
  margin-bottom: 2px;
  position: relative;
}

.message-wrapper.incoming {
  justify-content: flex-start;
}

.message-wrapper.outgoing {
  justify-content: flex-end;
}

/* Add spacing when sender changes */
.message-wrapper.new-sender {
  margin-top: 10px;
}

.message-bubble {
  max-width: 65%;
  min-width: 120px;
  padding: 6px 7px 8px 9px;
  border-radius: 8px;
  position: relative;
  word-wrap: break-word;
  overflow-wrap: break-word;
  box-shadow: 0 1px 0.5px rgba(11, 20, 26, 0.13);
}

.message-wrapper.incoming .message-bubble {
  background: var(--wa-message-in);
  border-top-left-radius: 0;
}

.message-wrapper.outgoing .message-bubble {
  background: var(--wa-message-out);
  border-top-right-radius: 0;
}

/* Message bubble tail */
.message-wrapper.incoming.new-sender .message-bubble::before {
  content: '';
  position: absolute;
  top: 0;
  left: -8px;
  width: 0;
  height: 0;
  border-top: 0 solid transparent;
  border-bottom: 13px solid transparent;
  border-right: 8px solid var(--wa-message-in);
}

.message-wrapper.outgoing.new-sender .message-bubble::after {
  content: '';
  position: absolute;
  top: 0;
  right: -8px;
  width: 0;
  height: 0;
  border-top: 0 solid transparent;
  border-bottom: 13px solid transparent;
  border-left: 8px solid var(--wa-message-out);
}

/* Sender name in group chat */
.message-sender {
  font-size: 12.5px;
  font-weight: 500;
  margin-bottom: 2px;
  line-height: 1.2;
  cursor: pointer;
}

.message-sender .sender-phone {
  font-size: 12px;
  font-weight: 400;
  color: var(--wa-text-light);
  margin-left: 6px;
}

/* Forwarded tag */
.message-forwarded {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--wa-forwarded-color);
  font-style: italic;
  margin-bottom: 2px;
}

.message-forwarded i {
  font-size: 14px;
}

/* Message text */
.message-text {
  font-size: 14.2px;
  line-height: 1.4;
  color: var(--wa-text-primary);
  white-space: pre-wrap;
}

/* Message footer (time + checks) */
.message-footer {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 3px;
  margin-top: 1px;
  float: right;
  margin-left: 12px;
  position: relative;
  top: 4px;
}

.message-time {
  font-size: 11px;
  color: var(--wa-text-time);
  white-space: nowrap;
}

.message-checks {
  font-size: 16px;
  color: var(--wa-blue-check);
  line-height: 1;
  display: flex;
  position: relative;
  width: 18px;
  height: 12px;
}

.message-checks .fa-check {
  font-size: 11px;
  position: absolute;
  top: 1px;
}

.message-checks .fa-check:first-child {
  left: 0;
}

.message-checks .fa-check:last-child {
  left: 5px;
}

/* ============================================
   MEDIA IN MESSAGES
   ============================================ */
.message-media {
  margin: -3px -4px 4px -4px;
  border-radius: 6px;
  overflow: hidden;
  position: relative;
  background: var(--wa-border);
}

.message-media img {
  width: 100%;
  display: block;
  max-height: 330px;
  object-fit: cover;
}

.message-media-caption {
  padding: 4px 0 0 0;
  font-size: 14.2px;
  line-height: 1.4;
  color: var(--wa-text-primary);
}

/* Video thumbnail in message */
.message-video-thumb {
  position: relative;
  cursor: pointer;
}

.message-video-thumb img {
  width: 100%;
  display: block;
  max-height: 330px;
  object-fit: cover;
}

.message-video-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0.25);
}

.message-video-play {
  width: 52px;
  height: 52px;
  border-radius: 50%;
  background: rgba(0, 0, 0, 0.55);
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid rgba(255, 255, 255, 0.85);
}

.message-video-play i {
  color: white;
  font-size: 22px;
  margin-left: 3px;
}

.message-video-duration {
  position: absolute;
  top: 8px;
  right: 8px;
  background: rgba(0, 0, 0, 0.6);
  color: white;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 500;
}

/* Link preview in message */
.message-link-preview {
  margin: -3px -4px 4px -4px;
  border-radius: 6px;
  overflow: hidden;
  background: var(--wa-search-bg);
  cursor: pointer;
  border: 1px solid var(--wa-border);
}

.message-link-preview:hover {
  background: #e5e8eb;
}

.message-link-thumb {
  width: 100%;
  height: 160px;
  overflow: hidden;
  background: var(--wa-border);
}

.message-link-thumb img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.message-link-info {
  padding: 8px 12px 10px;
}

.message-link-title {
  font-size: 13.5px;
  font-weight: 500;
  color: var(--wa-text-primary);
  line-height: 1.3;
  margin-bottom: 2px;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.message-link-domain {
  font-size: 12px;
  color: var(--wa-text-light);
  display: flex;
  align-items: center;
  gap: 4px;
}

.message-link-domain i {
  font-size: 10px;
}

/* ============================================
   DEBUG BADGE ON MESSAGES
   ============================================ */
.message-debug-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.message-debug-badge.tailored {
  background: rgba(24, 119, 242, 0.15);
  color: #1877F2;
}

.message-debug-badge.random {
  background: rgba(245, 166, 35, 0.15);
  color: #F5A623;
}

/* ============================================
   MESSAGE INPUT BAR
   ============================================ */
.chat-input-bar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  background: var(--wa-bg-panel);
  flex-shrink: 0;
  z-index: 2;
  min-height: var(--wa-input-height);
}

.chat-input-bar button {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: none;
  background: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--wa-text-light);
  font-size: 20px;
  flex-shrink: 0;
  transition: color 0.15s;
}

.chat-input-bar button:hover {
  color: var(--wa-text-secondary);
}

.chat-input-field {
  flex: 1;
  display: flex;
  align-items: center;
  background: var(--wa-bg-input);
  border-radius: 24px;
  padding: 9px 16px;
  min-height: 42px;
  border: 1px solid var(--wa-border);
  cursor: text;
}

.chat-input-field span {
  font-size: 14px;
  color: var(--wa-text-light);
  user-select: none;
}

.chat-input-send {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: none;
  background: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--wa-text-light);
  font-size: 22px;
  flex-shrink: 0;
}

/* ============================================
   COMING SOON TOOLTIP
   ============================================ */
.coming-soon-tooltip {
  position: fixed;
  z-index: 10000;
  background: var(--wa-text-primary);
  color: white;
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 500;
  pointer-events: none;
  opacity: 0;
  transform: translateY(4px);
  transition: opacity 0.2s, transform 0.2s;
  white-space: nowrap;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.coming-soon-tooltip.show {
  opacity: 1;
  transform: translateY(0);
}

/* ============================================
   RESULTS MODAL
   ============================================ */
.results-modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.65);
  z-index: 5000;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.results-modal.active {
  display: flex;
}

.results-card {
  background: var(--wa-white);
  border-radius: 12px;
  max-width: 480px;
  width: 100%;
  max-height: 80vh;
  overflow: auto;
  animation: resultsSlideUp 0.3s ease-out;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
}

@keyframes resultsSlideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.results-header {
  padding: 18px 20px;
  border-bottom: 1px solid var(--wa-border);
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--wa-bg-panel);
  border-radius: 12px 12px 0 0;
}

.results-header h2 {
  font-size: 18px;
  font-weight: 600;
  color: var(--wa-text-primary);
}

.results-close {
  background: none;
  border: none;
  font-size: 22px;
  color: var(--wa-text-light);
  cursor: pointer;
  padding: 4px;
  line-height: 1;
  border-radius: 50%;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.results-close:hover {
  background: var(--wa-hover);
  color: var(--wa-text-primary);
}

.results-content {
  padding: 12px 20px 20px;
}

.results-item {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 12px 0;
  border-bottom: 1px solid var(--wa-border);
}

.results-item:last-child {
  border-bottom: none;
}

.results-rank {
  width: 34px;
  height: 34px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--wa-teal), var(--wa-green-dark));
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 13px;
  flex-shrink: 0;
}

.results-info {
  flex: 1;
  min-width: 0;
}

.results-author {
  font-weight: 600;
  font-size: 14px;
  color: var(--wa-text-primary);
}

.results-type {
  font-size: 12px;
  color: var(--wa-text-secondary);
  margin-top: 2px;
}

.results-time {
  font-size: 17px;
  font-weight: 700;
  color: var(--wa-teal-dark);
  flex-shrink: 0;
}

.results-time small {
  font-size: 11px;
  font-weight: 400;
  color: var(--wa-text-secondary);
}

/* Results button */
#experience-results-btn {
  position: fixed;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 4000;
  background: linear-gradient(135deg, var(--wa-teal), var(--wa-green-dark));
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 24px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 4px 15px rgba(0, 168, 132, 0.4);
  transition: all 0.3s;
  display: none;
  align-items: center;
  gap: 8px;
}

#experience-results-btn:hover {
  transform: translateX(-50%) translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 168, 132, 0.5);
}

/* ============================================
   SCROLLBAR STYLING - thin and subtle
   ============================================ */
.chat-messages::-webkit-scrollbar,
.chat-list::-webkit-scrollbar {
  width: 4px;
}

.chat-messages::-webkit-scrollbar-track,
.chat-list::-webkit-scrollbar-track {
  background: transparent;
}

.chat-messages::-webkit-scrollbar-thumb,
.chat-list::-webkit-scrollbar-thumb {
  background: rgba(11, 20, 26, 0.16);
  border-radius: 4px;
}

.chat-messages::-webkit-scrollbar-thumb:hover,
.chat-list::-webkit-scrollbar-thumb:hover {
  background: rgba(11, 20, 26, 0.28);
}

/* Firefox thin scrollbar */
.chat-messages,
.chat-list {
  scrollbar-width: thin;
  scrollbar-color: rgba(11, 20, 26, 0.16) transparent;
}

/* ============================================
   MOBILE STYLES
   ============================================ */
@media (max-width: 768px) {
  :root {
    --wa-header-height: 56px;
    --wa-input-height: 56px;
  }

  /* Hide sidebar on mobile */
  .buzzchat-sidebar {
    display: none !important;
  }

  /* Show back button on mobile */
  .chat-header-back {
    display: flex;
  }

  /* Full width chat */
  .buzzchat-chat {
    width: 100%;
  }

  .buzzchat-app {
    max-width: 100%;
  }

  .buzzchat-top-bar {
    display: none;
  }

  .buzzchat-main {
    margin: 0;
  }

  /* Tighter message padding */
  .chat-messages {
    padding: 10px 12px;
  }

  .message-bubble {
    max-width: 85%;
  }

  /* Input bar adjustments */
  .chat-input-bar {
    padding: 6px 8px;
    gap: 4px;
  }

  .chat-input-bar button {
    width: 36px;
    height: 36px;
    font-size: 18px;
  }

  .chat-input-field {
    min-height: 38px;
    padding: 8px 14px;
    border-radius: 21px;
  }

  /* Results button mobile */
  #experience-results-btn {
    bottom: calc(var(--wa-input-height) + 16px);
    padding: 10px 20px;
    font-size: 13px;
  }
}

@media (max-width: 480px) {
  .chat-messages {
    padding: 8px 8px;
  }

  .message-bubble {
    max-width: 88%;
    min-width: 100px;
  }

  .chat-header {
    padding: 8px 10px;
    gap: 8px;
  }

  .chat-header-actions button {
    width: 36px;
    height: 36px;
    font-size: 16px;
  }

  .message-link-thumb {
    height: 130px;
  }
}

/* Safe areas for notched phones */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
  @media (max-width: 768px) {
    .chat-input-bar {
      padding-bottom: calc(8px + env(safe-area-inset-bottom));
    }

    #experience-results-btn {
      bottom: calc(var(--wa-input-height) + 16px + env(safe-area-inset-bottom));
    }
  }
}

/* Results modal mobile */
@media (max-width: 768px) {
  .results-modal {
    padding: 0;
    align-items: flex-end;
  }

  .results-card {
    max-width: 100%;
    max-height: 85vh;
    border-radius: 16px 16px 0 0;
  }

  .results-header {
    border-radius: 16px 16px 0 0;
  }
}

/* Touch improvements */
@media (hover: none) and (pointer: coarse) {
  .chat-list-item:hover {
    background: none;
  }

  .chat-list-item:active {
    background: var(--wa-hover);
  }

  .chat-header-actions button:hover,
  .sidebar-header-actions button:hover {
    background: none;
  }

  .message-link-preview:hover {
    background: var(--wa-search-bg);
  }

  .sidebar-filter:hover {
    background: var(--wa-search-bg);
  }

  .sidebar-filter.active:hover {
    background: var(--wa-teal-dark);
  }
}

/* Prevent pull-to-refresh */
@media (max-width: 768px) {
  body {
    overscroll-behavior-y: none;
  }
}

/* ============================================
   LOADING SCREEN MOBILE
   ============================================ */
@media (max-width: 480px) {
  .buzzchat-loader-icon {
    width: 56px;
    height: 56px;
  }

  .buzzchat-loader-icon i {
    font-size: 48px;
  }

  .buzzchat-loader-title {
    font-size: 15px;
  }

  .buzzchat-loader-bar {
    width: 200px;
  }
}
